一、Dubbo的组成

    1.Provider：暴露服务的提供方

	2.Consumer：远程服务的消费方

	3.Register：服务注册与发现的注册中心

	4.Monitor：统计服务调用次数和调用时间的监控中心

	5.Container：服务运行容器

二、Dubbo设置超时时间
	
	1.dubbo设置超时时间，是为了避免因为某种原因导致线程被长时间占用，最终出现线程池用完返回拒绝服务的异常。

	2.Dubbo设置超时时间，默认超时时间为1000MS，即1S

三、Dubbo调用不成功

	1.dubbo在调用服务不成功时，默认会重试2次。

	2.Dubbo的路由机制，会把超时的请求路由到其他机器上，而不是本机尝试，所以 dubbo的重试机制也能一定程度的保证服务的质量。

	3.但是如果不合理的配置重试次数，当失败时会进行重试多次，这样在某个时间点出现性能问题，调用方再连续重复调用

	4.dubbo如果出现超时，通常是业务处理太慢，可在服务提供方执行：jstack PID > jstack.log 分析线程都卡在哪个方法调用上，这里就是慢的原因。

四、Dubbo的意义
	
	1.Dubbo是一个分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案，以及SOA服务治理方案。

	2.简单的说,dubbo就是个服务框架，如果没有分布式的需求，其实是不需要用的，只有在分布式的时候，才有dubbo这样的分布式服务框架的需求，并且本质上是个服务调用的东东，说白了就是个远程服务调用的分布式框架

	3.dubbo作用,当分布式服务越来越多，容量的评估，小服务资源的浪费等问题逐渐显现，此时需增加一个调度中心基于访问压力实时管理集群容量，提高集群利用率。

五、Dubbo调优

	1、timeout，服务调用超时时间，如果客户端配置以客户端为准

	2、retries，远程服务调用重试次数，不包括第一次调用，不需要重试请设为0

	3、connections，对每个提供者的最大连接数，rmi、http、hessian等短连接协议表示限制连接数，dubbo等长连接协表示建立的长连接个数

	4、loadbalance，负载均衡策略，可选值：random,roundrobin,leastactive，分别表示：随机，轮循，最少活跃调用

	5、async，是否异步执行，不可靠异步，只是忽略返回值，不阻塞执行线程

	6、proxy，选择动态代理实现策略，可选：javassist, jdk

	7、client，客户端传输类型设置，如Dubbo协议的netty或mina

	8、actives，每服务消费者每服务每方法最大并发调用数

	9、cluster，集群方式，可选：【failover】
	
	失败自动切换，当出现失败，重试其他服务器（缺省），通常用于读操作，但重试会带来更长的延时，可通过retries=“2”来设置重试次数（不含第一次）

 六、zookeeper选举为什么只能是奇数

 	1.在zookeeper的选举过程中，为了保证选举过程最后能选出leader，就一定不能出现两台机器得票相同的僵局，所以一般的，要求zk集群的server数量一定要是奇数，也就是2n+1台，并且，如果集群出现问题，其中存活的机器必须大于n+1台，否则leader无法获得多数server的支持，系统就自动挂掉。所以一般是3个或者3个以上节点。


七、Zookeeper与Eureka的区别
	
	1、Zookeeper是主从架构

	2、Eureka是点对点，节点都是平级的

		1、Zookeeper当master挂了，会在30-120s进行leader选举，这点类似于redis的哨兵机制，在选举期间Zookeeper是不可用的，这么长时间不能进行服务注册，是无法忍受的，别说30s，5s都不能忍受。这时Zookeeper集群会瘫痪，这也是Zookeeper的CP，保持节点的一致性，牺牲了A/高可用。而Eureka不会，，这就是AP，牺牲了C/一致性。

		2、即使Eureka有部分挂掉，还有其他节点可以使用的，他们保持平级的关系，只不过信息有可能不一致，Eureka集群之间的消息广播可以实现数据的最终一致性


  八、Dubbo中zookeeper做注册中心，如果注册中心集群全都挂掉，发布者和订阅者之间还能通信么？、

  	  可以的，消费者在启动时，消费者会从zk拉取注册的生产者的地址接口等数据，缓存在本地。每次调用时，按照本地存储的地址进行调用

      可以的，消费者本地有一个生产者的列表，他会按照列表继续工作，但是无法从注册中心去同步最新的服务列表，短期的注册中心挂掉是不要紧的，但一定要尽快修复

      挂掉是不要紧的，但前提是你没有增加新的服务，如果你要调用新的服务，则是不能办到的

      注册中心对等集群，任意一台宕机后，将自动切换到另一台

      注册中心全部宕机，服务提供者和服务消费者仍能通过本地缓存通讯

 